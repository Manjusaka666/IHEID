\section{A simplified real-business cycle model with additive technology shocks}

\begin{problem}[1]
    Find the first-order condition (Euler equation) relating $C_t$ and $C_{t+1}$ in the following model:
\end{problem}

\begin{solution}
    The household's problem is to maximize
    \begin{equation*}
        \max_{\{C_t\}} E_{t} \sum_{t=0}^{\infty} u(C_t)/{(1+\rho)^t}
    \end{equation*}
    subject to the budget constraint
    \begin{equation*}
        K_{t+1} = K_t + Y_t - C_t
    \end{equation*}
    where $Y_t = A K_t + e_t$ and $e_t$ is a random technology shock satisfying $e_t = \phi e_{t-1} + \epsilon_t $, $-1 < \phi < 1$ and that $\epsilon_t$ is \textbf{i.i.d}.

    Define the Lagrange function:
    \begin{equation}
        \mathcal{L} = E_t  \sum_{t=0}^{\infty} \left[ u(C_t)/{(1+\rho)^t} - \lambda_t (K_{t+1} - K_t - Y_t + C_t) \right]
    \end{equation}
    The first-order condition with respect to $C_t$ is:
    \begin{equation}
        \frac{\partial \mathcal{L}}{\partial C_t} = 0 \Rightarrow \frac{u'(C_t)}{(1+\rho)^{t} } - \lambda_t = 0
    \end{equation}

    The first-order condition with respect to $K_{t+1}$ is:
    \begin{equation}
        \frac{\partial \mathcal{L}}{\partial K_{t+1}} = 0 \Rightarrow -\lambda_{t} + E_t\left[\lambda_{t+1}\right](1+\rho) = 0
    \end{equation}
    Combining (2) and (3) we get:
    \begin{equation}
        \frac{u'(C_t)}{(1+\rho)^{t} } = E_t\left[\lambda_{t+1}\right](1+\rho)
    \end{equation}
    We have the relationsjip between $C_t$ and $C_{t+1}$:
    \begin{equation}
        u'(C_t) = E_t\left[u'(C_{t+1})\right]
    \end{equation}
    Since $u(C_t) = C_t - \theta C_t^2$, we have $u'(C_t) = 1 - 2\theta C_t$. Thus, the Euler equation is:
    \begin{equation}
        1 - 2\theta C_t = E_t\left[1 - 2\theta C_{t+1}\right] \Rightarrow C_t = E_t\left[C_{t+1}\right]
    \end{equation}
\end{solution}

\begin{problem}[2]
    Guess that consumption takes the form$ C_t = \alpha  + \beta K_t + \gamma e_t$. What's $K_t$ in this case?
\end{problem}

\begin{solution}
    \begin{align*}
        K_{t+1} &= K_t + Y_t - C_t \\
        &= K_t + (A K_t + e_t) - \alpha - \beta K_t - \gamma e_t \\
        &= (1+A-\beta) K_t - \alpha + (1-\gamma) e_t
    \end{align*}
\end{solution}

\begin{problem}[3]
    What values must the parameters $\alpha $, $\beta$ , and $\gamma$ have for the first-order condition in part 1 to be
satisfied for all values of $K_t$ and $e_t$?
\end{problem}

\begin{solution}
    From the Euler equation, we have:
    \begin{equation}
        C_t = E_t\left[C_{t+1}\right]
    \end{equation}
    Substituting $C_t = \alpha  + \beta K_t + \gamma e_t$ and $C_{t+1} = \alpha  + \beta K_{t+1} + \gamma e_{t+1}$ into (7), we get:
    \begin{equation}
        \alpha  + \beta K_t + \gamma e_t = E_t\left[\alpha  + \beta K_{t+1} + \gamma e_{t+1}\right]
    \end{equation}
    Rearranging using $$E_t\left[e_{t+1}\right] = E_t \left[\phi e_t + \epsilon \right] = \phi e_t.$$
    Substituting $K_{t+1} = (1+A-\beta) K_t - \alpha - (1-\gamma) e_t$ into (8), we get:
    \begin{equation}
        \alpha  + \beta K_t + \gamma e_t = E_t\left[\alpha  + \beta ((1+A-\beta) K_t - \alpha + (1-\gamma) e_t) + \phi\gamma e_{t} + \gamma \epsilon_t \right]
    \end{equation}
    Simplifying (9) we get:
    \begin{align*}
        \alpha  + \beta K_t + \gamma e_t &= \alpha  + \beta (1+A-\beta) K_t - \alpha \beta  + \beta (1-\gamma) e_t + \phi\gamma e_{t} + \gamma E_t\left[\epsilon_t\right] \\
        \Rightarrow \beta K_t + \gamma e_t &= \beta (1+A-\beta) K_t - \alpha \beta  + \beta (1-\gamma) e_t + \phi\gamma e_{t} \\
    \end{align*}
    Hence, we have:
    \begin{align*}
        \alpha \beta  &= 0 \\
        \beta &= \beta (1+A-\beta) \\
        \gamma &= \beta (1-\gamma) + \phi\gamma
    \end{align*}
    SOlving the above equations, we get:
    \begin{align*}
        \alpha &= 0 \\
        \beta &= A = \rho \\
        \gamma &= \frac{\beta}{1+\beta -\phi} = \frac{A}{1+A -\phi}
    \end{align*}
\end{solution}

\begin{problem}[4]
    What are the effects of a one-time shock to $\epsilon $ on the paths of $Y$, $K$, and $C$?
\end{problem}

\begin{solution}
    \begin{equation}
        K_{t+1} = (1+A-\beta) K_t - \alpha + (1-\gamma) e_t = K_t + \frac{1-\phi}{1+A-\phi}e_t
    \end{equation}
    Thus, we can have:
    \begin{align*}
        K_{t+T} &= K_t + \sum_{j=0}^{T-1} \frac{1-\phi}{1+A-\phi}e_{t+j} \\
        &= K_t + \frac{1-\phi}{1+A-\phi} \sum_{j=0}^{T-1} \phi^j e_{t} \\
        \Rightarrow \lim_{T \to \infty} K_{t+T} &= K_t + \frac{1}{1+A-\phi} e_t
    \end{align*}

    For $C_t$:
    \begin{align*}
        C_t &= \alpha  + \beta K_t + \gamma e_t \\
        &= A K_t + \frac{A}{1+A-\phi} e_t
    \end{align*}
    \begin{align*}
        C_{t+1} &= A K_{t+1} + \frac{A}{1+A-\phi} e_{t+1} \\
        &= A \left[K_t + \frac{1-\phi}{1+A-\phi}e_t\right] + \frac{A}{1+A-\phi} e_{t+1}  \\
        &= A K_t + \frac{A(1-\phi )}{1+A-\phi} e_t + \frac{A}{1+A-\phi} e_{t+1} 
    \end{align*}
    Similarly,
    \begin{align*}
        C_{t+T} &= A K_{t+T} + \frac{A}{1+A-\phi} e_{t+T} \\
        &= A K_t + \frac{A}{1+A-\phi} \sum_{t=0}^{T-1} \phi^j e_t \\
        \Rightarrow \lim_{T \to \infty} C_{t+T} &= A K_t + \frac{A}{1+A-\phi} \phi^T e_t + \frac{A}{1+A-\phi} e_t
    \end{align*}
\end{solution}



\section{Solving the RBC model by finding the social optimum}

\begin{problem}[1]
    Explain the Bellman equation:
    \begin{equation}
        V(K_t, A_t) = \max_{C_t, L_t} \left\{\log{C_t} + b\log{(1-L_t)} + \beta E_t \left[V(K_{t+1}, A_{t+1})\right] \right\}
    \end{equation}
\end{problem}

\begin{solution}
    
\end{solution}

\begin{problem}[2]
    Given the log-linear structure of the model, let us guess that $V$ takes the form:
    $$V\left(K_t,A_t\right)=\gamma_0+\gamma_K\log K_t+\gamma_A\log A_t$$

    where the values of the $\beta$'s are to be determined. Substituting this conjectured form and the facts
    that $K_{t+1}=Y_t-C_t$ and $E_t\left[\log A_{t+1}\right]=\rho\log A_t$ into the Bellman equation yields
    $$V\left(K_t,A_t\right)=\max_{C_t,L_t}\left\{\log C_t+b\log\left(1-L_t\right)+\beta\left[\gamma_0+\gamma_K\log\left(Y_t-C_t\right)+\gamma_A\log A_t\right]\right\}.$$
    Find the frst-order condition for $C_t.$ Show that it implies that $C_t/Y_t$ does not depend on $K_t$ or $A_t.$
\end{problem}

\begin{solution}
    Based on our value function, the first-order condition for $C_t$ is:
    \begin{equation}
        \frac{\partial V}{\partial C_t} = 0 \Rightarrow \frac{1}{C_t} = \beta \gamma_K \frac{1}{Y_t - C_t} \Rightarrow \frac{C_t}{Y_t} = \frac{1}{1 + \beta \gamma_K}        
    \end{equation}
    Hence, $C_t/Y_t$ does not depend on $K_t$ or $A_t$.
\end{solution}

\begin{problem}[3]
    Find the first-order condition for $L_t.$ Use this condition and the result in part 2 to show that Lt
    does not depend on $K_t$ or $A_t$.
\end{problem}

\begin{solution}
    \begin{equation}
        \frac{\partial V}{\partial L_t} = 0 \Rightarrow -\frac{b}{1-L_t} + \beta \gamma_K \frac{1}{Y_t - C_t}(1-\alpha ) K_t^{\alpha }A_t^{1-\alpha }L_t^{-\alpha }   = 0
    \end{equation}
    Simplifying (12) we get:
    \begin{equation}
        -\frac{b}{1-L_t} + \frac{\beta \gamma_K}{Y_t - C_t}(1-\alpha ) \frac{Y_t}{L_t}= 0
    \end{equation}
    Replace $Y_t - C_t$ with $\beta \gamma_K C_t$:
    \begin{align*}
        &-\frac{b}{1-L_t} + \frac{\beta \gamma_K}{\beta \gamma_K C_t}(1-\alpha ) \frac{Y_t}{L_t}= 0 \\
        \Rightarrow & \frac{1-\alpha}{L_t} (1 + \beta \gamma_K) = \frac{b}{1-L_t} \\
        \Rightarrow & L_t = \frac{(1-\alpha)(1 + \beta \gamma_K)}{(1-\alpha)(1 + \beta \gamma_K) + b}
    \end{align*}
    So, $L_t$ does not depend on $K_t$ or $A_t$.
\end{solution}

\begin{problem}[4]
    Substitute the production function and the results in questions 2 and 3 for the optimal $C_t$ and $L_t$ into the equation above for $V$, and show that the resulting expression has the form $V(K_t,A_t)=$ $\gamma_0^{\prime}+\gamma_K^{\prime}\log K_t+\gamma_A^{\prime}\log A_t.$
\end{problem}

\begin{solution}
    As we know that
    \begin{align*}
        E_t\left[\log A_{t+1}\right] &= \rho\log A_t \\
        E_t\left[K_{t+1} \right] &= \log{(Y_t - C_t)}
    \end{align*}
    So, by substituting the optimal $C_t$ and $L_t$ into the equation for $V$, we get:
    \begin{align*}
        V(K_t, A_t) &= \log{\frac{Y_t}{1+\beta \gamma_K}} + b\log{\frac{b}{(1-\alpha)(1 + \beta \gamma_K) + b}} + \beta \left\{ \gamma_0 + \gamma_K \log{\frac{\beta \gamma_K Y_t}{1 + \beta \gamma_K}} + \gamma_A \rho \log{A_t} \right\} \\
    \end{align*}
    Substitute $Y_t = K_t^{\alpha }(A_t L_t)^{1-\alpha }$, we have:
    \begin{align*}
        V(K_t, A_t) &= \alpha \log{K_t} + (1-\alpha )\log{A_t} + (1-\alpha )\log{L_t} - \log{(1+\beta \gamma_K)} \\
        &+ b\log{\frac{b}{(1-\alpha)(1 + \beta \gamma_K) + b}} + \beta \gamma_0  \\
        &+ \beta \gamma_K\left\{\log{(\beta \gamma_K)} -\log{(1+\beta  \gamma_K)} + \alpha \log{K_t} + (1-\alpha )\log{A_t} + (1-\alpha )\log{L_t} \right\} \\
        &+ \beta \gamma_A \rho \log{A_t}
    \end{align*}
    Rearranging the terms, we get:
    \begin{align*}
        V(K_t, A_t) &= (\alpha +\alpha \beta \gamma_K)\log{K_t} + (1-\alpha + (1-\alpha )\beta \gamma_K + \beta \gamma_A \rho)\log{A_t} \\
        &+ (1-\alpha + (1-\alpha )\beta \gamma_K)\log{L_t} \\
        &- \log{(1+\beta \gamma_K)} + b\log{\frac{b}{(1-\alpha)(1 + \beta \gamma_K) + b}} + \beta \gamma_0  \\
        &+ \beta \gamma_K\log{(\beta \gamma_K)} - \beta \gamma_K\log{(1+\beta  \gamma_K)}
    \end{align*}
    We define: 
    \begin{align*}
        \gamma_K^{\prime} &= \alpha (1+ \beta \gamma_K) \\
        \gamma_A^{\prime} &= (1-\alpha )(\beta \gamma_K + 1) + \beta \gamma_A \rho \\
        \gamma_0^{\prime} &= \beta \gamma_0 + b\log{\frac{b}{(1-\alpha)(1 + \beta \gamma_K) + b}} - \log{(1+\beta \gamma_K)}(1+ \beta \gamma_K) \\
        &+ \beta \gamma_K\log{(\beta \gamma_K)} + (1-\alpha + (1-\alpha )\beta \gamma_K)\log{L_t}
    \end{align*}
    According to problem 3, we know that $L_t$ does not depend on $K_t$ or $A_t$, so, we could treat it as a constant in this expression about $K_t$ and $A_t$. Thus, we have:
    \begin{align*}
        V(K_t, A_t) &= \gamma_0^{\prime} + \gamma_K^{\prime}\log{K_t} + \gamma_A^{\prime}\log{A_t}.
    \end{align*}
\end{solution}

\begin{problem}[5]
    What must $\gamma_K$ and $\gamma_A$ be so that $\gamma_K^\prime=\gamma_K$ and $\gamma_A^{\prime}=\gamma_A?$
\end{problem}

\begin{solution}
    Let $\gamma_K^{\prime} = \gamma_K$ and $\gamma_A^{\prime} = \gamma_A$, we have:
    \begin{align*}
        \gamma_K &= \alpha (1+ \beta \gamma_K) \\
        \gamma_A &= (1-\alpha )(\beta \gamma_K + 1) + \beta \gamma_A \rho \\
        \Rightarrow \gamma_K &= \frac{\alpha}{1-\alpha \beta} \\
        \Rightarrow \gamma_A &= \frac{1-\alpha}{(1-\alpha \beta)(1 -\beta \rho )}
    \end{align*}
\end{solution}

\begin{problem}[6]
    What are the implied values of $C_t/Y_t$ and $L_t$? Are they the same as those found in the lecture?
\end{problem}

\begin{solution}
    Substitute $\gamma_K$ into the expression for $C_t/Y_t$ and $L_t$, we have:
    \begin{align*}
        \frac{C_t}{Y_t} &= \frac{1}{1 + \beta \gamma_K} = \frac{1}{1 + \beta \frac{\alpha}{1-\alpha \beta}} = 1-\alpha \beta \\
        L_t &= \frac{(1-\alpha)(1 + \beta \gamma_K)}{(1-\alpha)(1 + \beta \gamma_K) + b} = \frac{(1-\alpha)}{(1-\alpha) + b(1-\alpha \beta )}
    \end{align*}

\end{solution}